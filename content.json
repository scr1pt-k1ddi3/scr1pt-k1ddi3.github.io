{"meta":{"title":"scr1pt_k1ddi3' blog","subtitle":"","description":"","author":"scr1pt_k1ddi3","url":"https://scr1pt-k1ddi3.github.io","root":"/"},"pages":[{"title":"about","date":"2022-04-13T10:12:53.000Z","updated":"2022-04-17T11:56:56.618Z","comments":true,"path":"about.html","permalink":"https://scr1pt-k1ddi3.github.io/about.html","excerpt":"","text":"ğŸ’» å…³äºåšå®¢æœ¬ç«™çº¯å±çèƒ¡é—¹æçš„ï¼Œè¯·å„ä½å®¢å®˜ä¸è¦è½»ä¿¡â¤ï¸ï¼šğŸ˜ƒ å…³äºæˆ‘ğŸ˜ ä¸ªäººç®€ä»‹æœ¬äººæ˜¯ä¸€åªå°å‚»é¸ŸğŸ£ğŸ¥ğŸ¤ï¼Œå¤§èœç‹—ğŸ¶ï¼Œè¿˜è¯·å„ä½å®¢å®˜å¤šå¤šåŒ…å«,å¤šå¤šæŒ‡æ•™ğŸ™ğŸ™ğŸ™ã€‚ğŸ˜·å‚æ‚ŸçœŸè°›ï¼šå°ä¸‘åœ¨åº™å ‚ï¼Œ å¤§å¸ˆåœ¨æµæµªã€‚"},{"title":"æ–‡ç« å½’æ¡£","date":"2022-04-13T14:16:19.393Z","updated":"2022-04-13T13:25:15.839Z","comments":true,"path":"archive.html","permalink":"https://scr1pt-k1ddi3.github.io/archive.html","excerpt":"","text":""},{"title":"categories","date":"2022-04-13T10:54:10.000Z","updated":"2022-04-13T13:20:09.026Z","comments":true,"path":"categories/index.html","permalink":"https://scr1pt-k1ddi3.github.io/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"BUUCTF 2018 Online Tool","slug":"Tool","date":"2022-04-17T04:51:43.000Z","updated":"2022-04-17T12:25:20.689Z","comments":true,"path":"2022/04/17/Tool/","link":"","permalink":"https://scr1pt-k1ddi3.github.io/2022/04/17/Tool/","excerpt":"","text":"&lt;?php if (isset($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;])) &#123; $_SERVER[&#39;REMOTE_ADDR&#39;] = $_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]; &#125; if(!isset($_GET[&#39;host&#39;])) &#123; highlight_file(__FILE__); &#125; else &#123; $host = $_GET[&#39;host&#39;]; $host = escapeshellarg($host); $host = escapeshellcmd($host); $sandbox = md5(&quot;glzjin&quot;. $_SERVER[&#39;REMOTE_ADDR&#39;]); echo &#39;you are in sandbox &#39;.$sandbox; @mkdir($sandbox); chdir($sandbox); echo system(&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;.$host); &#125; è¿™é‡Œé¢ä¸»è¦æ˜¯ $host = escapeshellarg($host);$host = escapeshellcmd($host); è¿™é‡Œä¼šäº§ç”Ÿæ¼æ´ã€‚ escapeshellargå’Œescapeshellcmdè¿™ä¸¤ä¸ªå‡½æ•°åœ¨ä¸€èµ·ä½¿ç”¨æ—¶ä¼šé€ æˆæ¼æ´ã€‚ escapeshellarg è¿™ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯é˜²æ­¢å‘½ä»¤æ‰§è¡Œæ—¶è½¬ä¹‰â€™çš„å‡½æ•°ã€‚escapellargæ˜¯å°†â€™è½¬ä¹‰ï¼Œescapelshellcmdæ˜¯åœ¨\\å’Œâ€™ç­‰ä¹‹å‰åŠ \\è½¬ä¹‰ã€‚è¿™æ ·ä¼šé€ æˆæ¼æ´ï¼š escapeshellcmd è¿™ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯é˜²æ­¢å‘½ä»¤æ‰§è¡Œæ—¶è½¬ä¹‰â€™çš„å‡½æ•°ã€‚escapellargæ˜¯å°†â€™è½¬ä¹‰ï¼Œescapelshellcmdæ˜¯åœ¨\\å’Œâ€™ç­‰ä¹‹å‰åŠ \\è½¬ä¹‰ã€‚è¿™æ ·ä¼šé€ æˆæ¼æ´ï¼š æˆ‘ä»¬è¯¦ç»†åˆ†æä¸€ä¸‹ï¼š ä¼ å…¥çš„å‚æ•°æ˜¯ï¼š172.17.0.2&#39; -v -d a=1 ç»è¿‡escapeshellargå¤„ç†åå˜æˆäº†&#39;172.17.0.2&#39;\\&#39;&#39; -v -d a=1&#39;ï¼Œå³å…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ã€‚ ç»è¿‡escapeshellcmdå¤„ç†åå˜æˆ&#39;172.17.0.2&#39;\\\\&#39;&#39; -v -d a=1\\&#39;ï¼Œè¿™æ˜¯å› ä¸ºescapeshellcmdå¯¹\\ä»¥åŠæœ€åé‚£ä¸ªä¸é…å¯¹å„¿çš„å¼•å·è¿›è¡Œäº†è½¬ä¹‰ï¼šhttp://php.net/manual/zh/function.escapeshellcmd.php æœ€åæ‰§è¡Œçš„å‘½ä»¤æ˜¯curl &#39;172.17.0.2&#39;\\\\&#39;&#39; -v -d a=1\\&#39;ï¼Œç”±äºä¸­é—´çš„\\\\è¢«è§£é‡Šä¸º\\è€Œä¸å†æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥åé¢çš„&#39;æ²¡æœ‰è¢«è½¬ä¹‰ï¼Œä¸å†åé¢çš„&#39;é…å¯¹å„¿æˆäº†ä¸€ä¸ªç©ºç™½è¿æ¥ç¬¦ã€‚æ‰€ä»¥å¯ä»¥ç®€åŒ–ä¸ºcurl 172.17.0.2\\ -v -d a=1&#39;ï¼Œå³å‘172.17.0.2\\å‘èµ·è¯·æ±‚ï¼ŒPOST æ•°æ®ä¸ºa=1&#39;ã€‚ å›åˆ°mailä¸­ï¼Œæˆ‘ä»¬çš„ payload æœ€ç»ˆåœ¨æ‰§è¡Œæ—¶å˜æˆäº†&#39;-fa&#39;\\\\&#39;&#39;\\( -OQueueDirectory=/tmp -X/var/www/html/test.php \\)@a.com\\&#39;ï¼Œåˆ†å‰²åå°±æ˜¯-fa\\(ã€-OQueueDirectory=/tmpã€-X/var/www/html/test.phpã€)@a.com&#39;ï¼Œæœ€ç»ˆçš„å‚æ•°å°±æ˜¯è¿™æ ·è¢«æ³¨å…¥çš„ã€‚ psï¼šè¿™é‡Œå¥½åƒåªèƒ½æ˜¯linuxç¯å¢ƒä¸‹æ‰è¡Œã€‚ è¿™é‡Œå°±æ˜¯é€šè¿‡ç¬¬ä¸€æ¬¡çš„è½¬ä¹‰å˜æˆäº†&#39;172.17.0.2&#39;\\&#39;&#39; -v -d a=1&#39;ï¼Œç„¶åè¿™æ—¶æ˜¯172.17.0.2&#39; -v -d a=1è¿™æ ·ï¼Œç»è¿‡ç¬¬äºŒæ¬¡åæ˜¯&#39;172.17.0.2&#39;\\\\&#39;&#39; -v -d a=1\\&#39;ï¼Œ\\ä¼šè¢«è®¤ä¸ºæ˜¯\\æ‰€ä»¥å˜æˆäº†172.17.0.2\\ -v -d a=1&#39;è¿™æ ·çš„å‘½ä»¤ã€‚ è¿™æ—¶å€™æœç´¢å¯ä»¥å‘ç°åœ¨nmapå‘½ä»¤ä¸­ æœ‰ä¸€ä¸ªå‚æ•°-oGå¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™åˆ°æ–‡ä»¶ è¿™ä¸ªå‘½ä»¤å°±æ˜¯æˆ‘ä»¬çš„è¾“å…¥å¯æ§ï¼ç„¶åå†™å…¥åˆ°æ–‡ä»¶ï¼OKå¾ˆè‡ªç„¶çš„æƒ³åˆ°äº†ä¸Šä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬äº†â€¦ ?host&#x3D;â€™ -oG hack.php â€˜ (45æ¡æ¶ˆæ¯) BUUCTF 2018 Online Tool_kidçš„åšå®¢-CSDNåšå®¢_buuctf escapeshellargä¸escapeshellcmdå…±ä¼¤ - NineOne_E - åšå®¢å›­ (cnblogs.com) PHP escapeshellarg()+escapeshellcmd() ä¹‹æ®‡ (seebug.org)","categories":[{"name":"CTF","slug":"CTF","permalink":"https://scr1pt-k1ddi3.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://scr1pt-k1ddi3.github.io/tags/CTF/"},{"name":"Web","slug":"Web","permalink":"https://scr1pt-k1ddi3.github.io/tags/Web/"}]},{"title":"hello world","slug":"hello-world","date":"2021-04-08T06:45:37.000Z","updated":"2022-04-17T12:26:27.939Z","comments":true,"path":"2021/04/08/hello-world/","link":"","permalink":"https://scr1pt-k1ddi3.github.io/2021/04/08/hello-world/","excerpt":"","text":"Hello WorldğŸ‘½! &lt;?php highlight_file(__FILE__); error_reporting(0); $file = &quot;1nD3x.php&quot;; $shana = $_GET[&#39;shana&#39;]; $passwd = $_GET[&#39;passwd&#39;]; $arg = &#39;&#39;; $code = &#39;&#39;; echo &quot;&lt;br /&gt;&lt;font color=red&gt;&lt;B&gt;This is a very simple challenge and if you solve it I will give you a flag. Good Luck!&lt;/B&gt;&lt;br&gt;&lt;/font&gt;&quot;; if($_SERVER) &#123; if ( preg_match(&#39;/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\\.|\\&quot;|\\&#39;|log/i&#39;, $_SERVER[&#39;QUERY_STRING&#39;]) ) die(&#39;You seem to want to do something bad?&#39;); &#125; if (!preg_match(&#39;/http|https/i&#39;, $_GET[&#39;file&#39;])) &#123; if (preg_match(&#39;/^aqua_is_cute$/&#39;, $_GET[&#39;debu&#39;]) &amp;&amp; $_GET[&#39;debu&#39;] !== &#39;aqua_is_cute&#39;) &#123; $file = $_GET[&quot;file&quot;]; echo &quot;Neeeeee! Good Job!&lt;br&gt;&quot;; &#125; &#125; else die(&#39;fxck you! What do you want to do ?!&#39;); if($_REQUEST) &#123; foreach($_REQUEST as $value) &#123; if(preg_match(&#39;/[a-zA-Z]/i&#39;, $value)) die(&#39;fxck you! I hate English!&#39;); &#125; &#125; if (file_get_contents($file) !== &#39;debu_debu_aqua&#39;) die(&quot;Aqua is the cutest five-year-old child in the world! Isn&#39;t it ?&lt;br&gt;&quot;); if ( sha1($shana) === sha1($passwd) &amp;&amp; $shana != $passwd )&#123; extract($_GET[&quot;flag&quot;]); echo &quot;Very good! you know my password. But what is flag?&lt;br&gt;&quot;; &#125; else&#123; die(&quot;fxck you! you don&#39;t know my password! And you don&#39;t know sha1! why you come here!&quot;); &#125; if(preg_match(&#39;/^[a-z0-9]*$/isD&#39;, $code) || preg_match(&#39;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\\`|\\&#123;|\\%|x|\\&amp;|\\$|\\*|\\||\\&lt;|\\&quot;|\\&#39;|\\=|\\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\\.|log|\\^/i&#39;, $arg) ) &#123; die(&quot;&lt;br /&gt;Neeeeee~! I have disabled all dangerous functions! You can&#39;t get my flag =w=&quot;); &#125; else &#123; include &quot;flag.php&quot;; $code(&#39;&#39;, $arg); &#125; ?&gt;","categories":[{"name":"hello","slug":"hello","permalink":"https://scr1pt-k1ddi3.github.io/categories/hello/"}],"tags":[{"name":"hello","slug":"hello","permalink":"https://scr1pt-k1ddi3.github.io/tags/hello/"}]}],"categories":[{"name":"CTF","slug":"CTF","permalink":"https://scr1pt-k1ddi3.github.io/categories/CTF/"},{"name":"hello","slug":"hello","permalink":"https://scr1pt-k1ddi3.github.io/categories/hello/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://scr1pt-k1ddi3.github.io/tags/CTF/"},{"name":"Web","slug":"Web","permalink":"https://scr1pt-k1ddi3.github.io/tags/Web/"},{"name":"hello","slug":"hello","permalink":"https://scr1pt-k1ddi3.github.io/tags/hello/"}]}