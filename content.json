{"meta":{"title":"scr1pt_k1ddi3' blog","subtitle":"","description":"","author":"scr1pt_k1ddi3","url":"https://scr1pt-k1ddi3.github.io","root":"/"},"pages":[{"title":"about","date":"2022-04-13T10:12:53.000Z","updated":"2022-04-18T15:55:34.050Z","comments":true,"path":"about.html","permalink":"https://scr1pt-k1ddi3.github.io/about.html","excerpt":"","text":"ğŸ’» å…³äºåšå®¢æœ¬ç«™çº¯å±çèƒ¡é—¹æçš„ï¼Œè¯·å„ä½å®¢å®˜ä¸è¦è½»ä¿¡â¤ï¸ï¼šğŸ˜ƒ å…³äºæˆ‘ğŸ˜ ä¸ªäººç®€ä»‹æœ¬äººæ˜¯ä¸€åªå°å‚»é¸ŸğŸ£ğŸ¥ğŸ¤ï¼Œå¤§èœç‹—ğŸ¶ï¼Œè¿˜è¯·å„ä½å®¢å®˜å¤šå¤šåŒ…å«,å¤šå¤šæŒ‡æ•™ğŸ™ğŸ™ğŸ™ã€‚ğŸ˜·å‚æ‚ŸçœŸè°›ï¼šä½›æ›°ï¼šä¿±ä»¥è±†çš¤æƒ³å‘ä¸è–©ç¼½å¤šç¤™é¡›å¥¢é‚£çš¤æ­»å†¥çˆæ‚‰ç©¶ä¾„ç‰¹çš¤è‹¦å€’è€å’’ä¾„çœŸç›¡è‹¦å‘é å¥¢é®å‰çš¤ç‘Ÿå†¥ç‰¹ä¾å“†æ•¸ç©†å’’åˆ©ä¿±çˆ"},{"title":"æ–‡ç« å½’æ¡£","date":"2022-04-13T14:16:19.393Z","updated":"2022-04-13T13:25:15.839Z","comments":true,"path":"archive.html","permalink":"https://scr1pt-k1ddi3.github.io/archive.html","excerpt":"","text":""},{"title":"friends","date":"2022-04-18T14:51:39.000Z","updated":"2022-04-18T15:50:53.074Z","comments":true,"path":"PY.html","permalink":"https://scr1pt-k1ddi3.github.io/PY.html","excerpt":"","text":"ä½ æˆ‘å¼Ÿå…„ï¼Œè¾ˆå­å¼Ÿå…„ã€‚å…¶ä»–å¼Ÿå…„ï¼Œéƒ½æ˜¯å†’å……ï¼ ğŸ’ªğŸ˜ scr1pt_k1ddi3â€™å¼Ÿå…„â¤ï¸â¤ï¸â¤ï¸"},{"title":"categories","date":"2022-04-13T10:54:10.000Z","updated":"2022-04-13T13:20:09.026Z","comments":true,"path":"categories/index.html","permalink":"https://scr1pt-k1ddi3.github.io/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"BUUCTF 2018 Online Tool","slug":"Tool","date":"2022-04-17T04:51:43.000Z","updated":"2022-04-17T12:25:20.689Z","comments":true,"path":"2022/04/17/Tool/","link":"","permalink":"https://scr1pt-k1ddi3.github.io/2022/04/17/Tool/","excerpt":"","text":"&lt;?php if (isset($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;])) &#123; $_SERVER[&#39;REMOTE_ADDR&#39;] = $_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]; &#125; if(!isset($_GET[&#39;host&#39;])) &#123; highlight_file(__FILE__); &#125; else &#123; $host = $_GET[&#39;host&#39;]; $host = escapeshellarg($host); $host = escapeshellcmd($host); $sandbox = md5(&quot;glzjin&quot;. $_SERVER[&#39;REMOTE_ADDR&#39;]); echo &#39;you are in sandbox &#39;.$sandbox; @mkdir($sandbox); chdir($sandbox); echo system(&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;.$host); &#125; è¿™é‡Œé¢ä¸»è¦æ˜¯ $host = escapeshellarg($host);$host = escapeshellcmd($host); è¿™é‡Œä¼šäº§ç”Ÿæ¼æ´ã€‚ escapeshellargå’Œescapeshellcmdè¿™ä¸¤ä¸ªå‡½æ•°åœ¨ä¸€èµ·ä½¿ç”¨æ—¶ä¼šé€ æˆæ¼æ´ã€‚ escapeshellarg è¿™ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯é˜²æ­¢å‘½ä»¤æ‰§è¡Œæ—¶è½¬ä¹‰â€™çš„å‡½æ•°ã€‚escapellargæ˜¯å°†â€™è½¬ä¹‰ï¼Œescapelshellcmdæ˜¯åœ¨\\å’Œâ€™ç­‰ä¹‹å‰åŠ \\è½¬ä¹‰ã€‚è¿™æ ·ä¼šé€ æˆæ¼æ´ï¼š escapeshellcmd è¿™ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯é˜²æ­¢å‘½ä»¤æ‰§è¡Œæ—¶è½¬ä¹‰â€™çš„å‡½æ•°ã€‚escapellargæ˜¯å°†â€™è½¬ä¹‰ï¼Œescapelshellcmdæ˜¯åœ¨\\å’Œâ€™ç­‰ä¹‹å‰åŠ \\è½¬ä¹‰ã€‚è¿™æ ·ä¼šé€ æˆæ¼æ´ï¼š æˆ‘ä»¬è¯¦ç»†åˆ†æä¸€ä¸‹ï¼š ä¼ å…¥çš„å‚æ•°æ˜¯ï¼š172.17.0.2&#39; -v -d a=1 ç»è¿‡escapeshellargå¤„ç†åå˜æˆäº†&#39;172.17.0.2&#39;\\&#39;&#39; -v -d a=1&#39;ï¼Œå³å…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ã€‚ ç»è¿‡escapeshellcmdå¤„ç†åå˜æˆ&#39;172.17.0.2&#39;\\\\&#39;&#39; -v -d a=1\\&#39;ï¼Œè¿™æ˜¯å› ä¸ºescapeshellcmdå¯¹\\ä»¥åŠæœ€åé‚£ä¸ªä¸é…å¯¹å„¿çš„å¼•å·è¿›è¡Œäº†è½¬ä¹‰ï¼šhttp://php.net/manual/zh/function.escapeshellcmd.php æœ€åæ‰§è¡Œçš„å‘½ä»¤æ˜¯curl &#39;172.17.0.2&#39;\\\\&#39;&#39; -v -d a=1\\&#39;ï¼Œç”±äºä¸­é—´çš„\\\\è¢«è§£é‡Šä¸º\\è€Œä¸å†æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥åé¢çš„&#39;æ²¡æœ‰è¢«è½¬ä¹‰ï¼Œä¸å†åé¢çš„&#39;é…å¯¹å„¿æˆäº†ä¸€ä¸ªç©ºç™½è¿æ¥ç¬¦ã€‚æ‰€ä»¥å¯ä»¥ç®€åŒ–ä¸ºcurl 172.17.0.2\\ -v -d a=1&#39;ï¼Œå³å‘172.17.0.2\\å‘èµ·è¯·æ±‚ï¼ŒPOST æ•°æ®ä¸ºa=1&#39;ã€‚ å›åˆ°mailä¸­ï¼Œæˆ‘ä»¬çš„ payload æœ€ç»ˆåœ¨æ‰§è¡Œæ—¶å˜æˆäº†&#39;-fa&#39;\\\\&#39;&#39;\\( -OQueueDirectory=/tmp -X/var/www/html/test.php \\)@a.com\\&#39;ï¼Œåˆ†å‰²åå°±æ˜¯-fa\\(ã€-OQueueDirectory=/tmpã€-X/var/www/html/test.phpã€)@a.com&#39;ï¼Œæœ€ç»ˆçš„å‚æ•°å°±æ˜¯è¿™æ ·è¢«æ³¨å…¥çš„ã€‚ psï¼šè¿™é‡Œå¥½åƒåªèƒ½æ˜¯linuxç¯å¢ƒä¸‹æ‰è¡Œã€‚ è¿™é‡Œå°±æ˜¯é€šè¿‡ç¬¬ä¸€æ¬¡çš„è½¬ä¹‰å˜æˆäº†&#39;172.17.0.2&#39;\\&#39;&#39; -v -d a=1&#39;ï¼Œç„¶åè¿™æ—¶æ˜¯172.17.0.2&#39; -v -d a=1è¿™æ ·ï¼Œç»è¿‡ç¬¬äºŒæ¬¡åæ˜¯&#39;172.17.0.2&#39;\\\\&#39;&#39; -v -d a=1\\&#39;ï¼Œ\\ä¼šè¢«è®¤ä¸ºæ˜¯\\æ‰€ä»¥å˜æˆäº†172.17.0.2\\ -v -d a=1&#39;è¿™æ ·çš„å‘½ä»¤ã€‚ è¿™æ—¶å€™æœç´¢å¯ä»¥å‘ç°åœ¨nmapå‘½ä»¤ä¸­ æœ‰ä¸€ä¸ªå‚æ•°-oGå¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™åˆ°æ–‡ä»¶ è¿™ä¸ªå‘½ä»¤å°±æ˜¯æˆ‘ä»¬çš„è¾“å…¥å¯æ§ï¼ç„¶åå†™å…¥åˆ°æ–‡ä»¶ï¼OKå¾ˆè‡ªç„¶çš„æƒ³åˆ°äº†ä¸Šä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬äº†â€¦ ?host&#x3D;â€™ -oG hack.php â€˜ (45æ¡æ¶ˆæ¯) BUUCTF 2018 Online Tool_kidçš„åšå®¢-CSDNåšå®¢_buuctf escapeshellargä¸escapeshellcmdå…±ä¼¤ - NineOne_E - åšå®¢å›­ (cnblogs.com) PHP escapeshellarg()+escapeshellcmd() ä¹‹æ®‡ (seebug.org)","categories":[{"name":"CTF","slug":"CTF","permalink":"https://scr1pt-k1ddi3.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://scr1pt-k1ddi3.github.io/tags/CTF/"},{"name":"Web","slug":"Web","permalink":"https://scr1pt-k1ddi3.github.io/tags/Web/"}]}],"categories":[{"name":"CTF","slug":"CTF","permalink":"https://scr1pt-k1ddi3.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://scr1pt-k1ddi3.github.io/tags/CTF/"},{"name":"Web","slug":"Web","permalink":"https://scr1pt-k1ddi3.github.io/tags/Web/"}]}